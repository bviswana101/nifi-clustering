apiVersion: v1
kind: ConfigMap
metadata:
  name: nifi-bootstrap
data:
  run.sh: |-
    echo "Waiting to run nslookup..."
    sleep 30
    echo "$(getent hosts zk-0.zk-hs.nifi.svc.cluster.local) zk-0" >>  /tmphosts
    echo "$(getent hosts zk-1.zk-hs.nifi.svc.cluster.local) zk-1" >>  /tmphosts
    echo "$(getent hosts zk-2.zk-hs.nifi.svc.cluster.local) zk-2" >>  /tmphosts
    cat /tmphosts >> /etc/hosts

    #increase java memory 
    sed -i -e 's/Xmx24m/Xmx4096m/g' /opt/nifi/bin/nifi.sh

    #add nar files
    

    #start nifi
    ./start_nifi.sh
